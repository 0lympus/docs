<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Service Modules - Olympus Docs</title>
      
      
      
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="Olympus Docs">
    <meta property="og:image" content="None/../../../../">
    <meta name="apple-mobile-web-app-title" content="Olympus Docs">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../../../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../../../../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../../../assets/fonts/icon.eot?52m981');
      	src: url('../../../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../../../assets/stylesheets/application-a422ff04cc.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
    <script src="../../../../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class=" ">
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                Developer <i class="icon icon-link"></i>
              
            
              
                Modules <i class="icon icon-link"></i>
              
            
          </span>
        
        Service Modules
      </div>
    </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="/" class="project">
    <div class="banner">
      
      <div class="name">
        <strong>
          Olympus Docs
          <span class="version">
            
          </span>
        </strong>
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Home" href="../../../..">
      Home
    </a>
    
  </li>

          
            
  <li>
    <span class="section">Developer</span>
    <ul>
      
        
  <li>
    <span class="section">Modules</span>
    <ul>
      
        
  <li>
    <a class="" title="Get Started" href="../../get-started/">
      Get Started
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Client Modules" href="../../client-modules/get-started/">
      Client Modules
    </a>
    
  </li>

      
        
  <li>
    <a class="current" title="Service Modules" href="./">
      Service Modules
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="Setting up a new web application" href="#setting-up-a-new-web-application">
                Setting up a new web application
              </a>
            </li>
          
            <li class="anchor">
              <a title="Adding an existing module" href="#adding-an-existing-module">
                Adding an existing module
              </a>
            </li>
          
        </ul>
      
    
  </li>

      
    </ul>
  </li>

      
        
  <li>
    <a class="" title="Tools" href="../../../tools/get-started/">
      Tools
    </a>
    
  </li>

      
    </ul>
  </li>

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <h1 id="get-started-with-phoenix-service-modules">Get Started with Phoenix Service Modules</h1>
<p>The Phoenix platform provides a web application base for building modular web services on the ASP.Net framework. It brings together the following elements.</p>
<ul>
<li>ASP.Net Web API</li>
<li>ASP.Net Identity Framework</li>
<li>Dependency Injection using SimpleInjector</li>
</ul>
<h2 id="setting-up-a-new-web-application">Setting up a new web application</h2>
<p>To begin a new web application, create a new, empty ASP.Net Web API project and install the Phoenix Web package.</p>
<pre><code>PM&gt; Install-Package Phoenix.Web
</code></pre>

<p>Then add a new <code>Startup.cs</code> file with the following contents.</p>
<p>```c#
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using Microsoft.Owin;
using Owin;
using Phoenix.Web;</p>
<p>[assembly: OwinStartup(typeof(MyWebApplication.Startup))]</p>
<p>namespace MyWebApplication
{
    public class Startup
    {</p>
<pre><code>    public void Configuration(IAppBuilder app)
    {
        app.UsePhoenix();
    }
}
</code></pre>
<p>}</p>
<pre><code>
That's all you have to do to get a modular web application running using the Phoenix platform.

## Add a new module
To create a new service module, add a new empty class library project to your solution.

It is recommended that you add a folder for `Controllers` and `Permissions` but you may put these classes where ever you like.

![Module Structure](resources/get-started-solution.png)

Add a class to define information about your module. For this example, we've added  the `MyModule` class which implements the `IPhoenixModule` interface. Implement the required members as follows.

```c#
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace MyModule
{
    public class MyModule : IPhoenixModule
    {
        public string Name
        {
            get
            {
                return &quot;My Module&quot;;
            }
        }

        public string Description
        {
            get
            {
                return &quot;My Module does some really great stuff.&quot;;
            }
        }

        /// &lt;summary&gt;
        /// Returns all permission groups for the module
        /// &lt;/summary&gt;
        public IEnumerable&lt;IPermissionGroup&gt; PermissionGroups
        {
            get
            {
                return new List&lt;IPermissionGroup&gt;()
                {
                    new Permissions.MyFeaturePermissions()
                };
            }
        }

        public MyModule(/*Use dependency injection to inject any dependencies here*/)
        {
            //Module initialisation code goes here.
        }

        public void Configure(params object[] args)
        {
            //You can configure the module here.
            //This is called when the web application starts.
        }
    }
}

</code></pre>

<p>You may have noticed the <code>PermissionGroups</code> member. We'll get to that in the next section. For now, you may simply add Web API controllers to the controllers folder and compile. Copy the compiled dll to the <code>bin/Modules</code> under the MyWebApplication project. The dll is loaded and everything is ready for you to start using the controllers in this module.</p>
<h3 id="configuring-module-permissions">Configuring module permissions</h3>
<p>You can configure module permissions for use with the <code>Phoenix.Security</code> package.</p>
<p>Install the <code>Phoenix.Security</code> package using the following command.</p>
<pre><code>PM&gt; Install-Package Phoenix.Security
</code></pre>

<p>Service modules, expose a list of <code>PermissionGroups</code>. A <code>PermissionGroup</code> is intended to define a set of permissions for a specific feature of your module. For example, if your module deals with products and you want to secure these you might define a permission group for products with the following permissions.</p>
<ul>
<li>Can View Product</li>
<li>Can Create Product</li>
<li>Can Edit Product</li>
<li>Can Delete Product</li>
</ul>
<p>This will allow you to control all CRUD related aspects of a product where only certain users can delete a product.</p>
<p>A permission group can be define as follows.</p>
<p>```c#
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;</p>
<p>namespace MyModule.Permissions
{
    public class MyFeaturePermissions
    {
        public string Description
        {
            get
            {
                return "Controls access to process my feautre.";
            }
        }</p>
<pre><code>    public string Name
    {
        get
        {
            return "My Feature";
        }
    }

    public IEnumerable&lt;IPermission&gt; Permissions
    {
        get
        {
            return new List&lt;IPermission&gt;
            {
                new CanViewMyFeature(),
                new CanCreateMyFeature(),
                new CanDeleteMyFeature(),
                new CanEditMyFeature()
            };
        }
    }

    public class CanViewMyFeature : PermissionBase, IPermission
    {
        public string Name { get { return "View"; } }
        public string Description { get { return "Provides access to view My Feature"; } }
    }

    public class CanCreateMyFeature : PermissionBase, IPermission
    {
        public string Name { get { return "Create"; } }
        public string Description { get { return "Provides access to create new My Feature"; } }
    }

    public class CanDeleteMyFeature : PermissionBase, IPermission
    {
        public string Name { get { return "Delete"; } }
        public string Description { get { return "Provides access to delete My Feature"; } }
    }

    public class CanEditMyFeature : PermissionBase, IPermission
    {
        public string Name { get { return "Edit"; } }
        public string Description { get { return "Provides access to change My Feature"; } }
    }
}
</code></pre>
<p>}</p>
<pre><code>
To use permissions in a controller or anywhere throughout your code, you can use the `IPhoenixAccess` component can be acquired using dependency injection. The following code demonstrates this.

```c#
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Web.Http;
using Phoenix.Access;
using static MyModule.Permissions.MyFeaturePermissions;

namespace MyModule.Controllers
{
    public class MyFeatureController
    {
        IPhoenixAccess access;

        public MyFeatureController(IPhoenixAccess access /*Injected via DI*/)
        {
            this.access = access;
        }

        /// &lt;summary&gt;
        /// List all existing items of my feature
        /// &lt;/summary&gt;
        /// &lt;returns&gt;My features items&lt;/returns&gt;
        [HttpGet]
        [Route(&quot;&quot;)]
        public IEnumerable&lt;string&gt; ListItems()
        {
            access.CheckAccess&lt;CanViewMyFeature&gt;(RequestContext.Principal);

            return new[] { &quot;Item 1&quot;, &quot;Item 2&quot; };
        }
    }
}

</code></pre>

<p>If the current user (Principal) does not have access for this permission an exception will be thrown and the code will not continue to execute.</p>
<h2 id="adding-an-existing-module">Adding an existing module</h2>
<p>You can use NuGet to install a module from a NuGet feed.</p>
<p>Comming Soon!</p>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../../client-modules/get-started/" title="Client Modules">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Client Modules
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../../../tools/get-started/" title="Tools">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Tools
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../../../..';
      var repo_id  = '';
    </script>
    <script src="../../../../assets/javascripts/application-997097ee0c.js"></script>
    
    
  </body>
</html>